--- 
layout: post
title: Secondary Indexes with libcassandra in C++
category: cassandra
---
<p>
Last weekend I updated my high-level C++ client for Cassandra, <a href="https://github.com/posulliv/libcassandra/">libcassandra</a> to support a lot of the new features in the 0.7 Cassandra release. In particular, one of the new features is secondary indexes and I wanted to very briefly outline how secondary indexes can be used programatically in libcassandra.
</p>

<p>
An <a href="http://www.datastax.com/dev/blog/whats-new-cassandra-07-secondary-indexes">article</a> by Datastax gives a great overview of secondary indexes. I'm going to use the example in that article here.
</p>

<p>
The first thing which we must do is create a keyspace and column family. This is accomplished in libcassandra like:
</p>

<script src="https://gist.github.com/846780.js"></script>

<p>
After creating a keyspace and column family for working with, we next want to insert some sample data. I'll use the sample data inserted in the article but instead of inserting it through the CLI, I'll insert it using libcassandra:
</p>

<script src="https://gist.github.com/846777.js"></script>

<p>
Next, to perform the same query as was used in the article, the code looks like:
</p>

<script src="https://gist.github.com/846782.js"></script>

<p>
Currently, the result set is a <code>std::map</code> of row keys to an inner <code>std::map</code> of column names to column values. I plan on adding support for the result to contain more information about each row in the result set in the future.
</p>

